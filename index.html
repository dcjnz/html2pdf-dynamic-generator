<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Oferta PDF (tekstowy)</title>

  <!-- pdfmake i czcionki -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>

  <!-- html2pdfmake (UMD build) -->
  <script src="https://cdn.jsdelivr.net/npm/html2pdfmake/browser.js"></script>
</head>
<body>
  <div id="output" style="display: none;"></div>

  <script>
    const htmlEnc = new URLSearchParams(window.location.search).get('html');
    if (!htmlEnc) {
      document.body.innerText = '❗ Brak parametru ?html=...';
      return;
    }

    const html = decodeURIComponent(htmlEnc);
    const output = document.getElementById('output');
    output.innerHTML = html;

    // Konwersja HTML → pdfmake
    const docDef = {
      content: htmlToPdfmake(output, {
        window: window,
        defaultStyles: { fontSize: 12 },
        collapseWhitespace: true,
        tableAutoSize: true
      }),
      styles: {
        header: { fontSize: 18, bold: true }
      },
      defaultStyle: { font: 'Helvetica' }
    };

    // Generuj PDF
    pdfMake.createPdf(docDef).open();
  </script>
</body>
</html>
